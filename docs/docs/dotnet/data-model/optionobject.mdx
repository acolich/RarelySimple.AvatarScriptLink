---
title: OptionObject (legacy)
sidebar_position: 3
--displayed_sidebar: dotnetSidebar
---

# OptionObject

:::tip Legacy Object

A newer version of this object is now available ([OptionObject2015](./optionobject2015)) and is recommended for new projects.

:::

The OptionObject holds all of the content of and metadata describing the calling myAvatar form.

## Properties

| Property        | Description                                                                 |
|:----------------|:----------------------------------------------------------------------------|
| EntityID        | The unique Id of the selected entity. I.e., Patient, Staff, or User.        |
| EpisodeNumber   | The selected Episode Number. Will be null if the form is non-episodic.       |
| ErrorCode       | Informs myAvatar of the outcome of the ScriptLink API call.                 |
| ErrorMesg       | Message to display to user with certain error codes.                        |
| Facility        | The Facility Id the user is currently working in.                           |
| Forms           | List of myAvatar form sections including rows and fields. See [FormObject](./formobject). |
| OptionId        | The unique Id of the form that sent this request.                           |
| OptionStaffId   | The Staff Id assigned to the logged on user. May be null/empty if not associated with a Practitioner. |
| OptionUserId    | The User Id of the logged on user.                                          |
| ServerName      | The server the request was submitted from.                                  |
| SystemCode      | The System Code the user is currently working in.                           |

## Methods

The following methods are available on the OptionObject to assist with common tasks.

| Method                                        | Description |
|:----------------------------------------------|:------------|
| AddFormObject([FormObject](./formobject))     | Adds a [FormObject](./formobject) to the OptionObject.            |
| AddFormObject(string, bool)                   | Creates a [FormObject](./formobject) with specified FormId and adds to the OptionObject2015. The second parameter specifies whether the [FormObject](./formobject) should be flagged as a Multiple Iteration form. |
| AddRowObject(string, [RowObject](./rowobject))| Adds a [RowObject](./rowobject) to the [FormObject](./formobject) with the specified FormId. |
| Clone                                         | Clones the OptionObject.            |
| DeleteRowObject([RowObject](./rowobject))     | Marks a <see cref="RowObject"/> for deletion.            |
| DeleteRowObject(string)                       | Marks a <see cref="RowObject"/> for deletion by specified RowId.            |
| DisableAllFieldObjects()                      | Sets all [FieldObjects](./fieldobject) as disabled.            |
| DisableAllFieldObjects(List of string)          | Sets all [FieldObjects](./fieldobject) as disabled except for any listed to be excluded.            |
| Equals(OptionObjectBase)                      | Used to compare two OptionObject to determine if they are equal. Returns bool.            |
| Equals(object)                                | Used to compare OptionObject to an object to determine if they are equal. Returns bool.            |
| GetCurrentRowId(string)                       | Returns the CurrentRow RowId of the form matching the FormId.            |
| GetFieldValue(string)                         | Returns the first value of the field matching the Field Number.            |
| GetFieldValue(string, string, string)         | Returns the value of the <see cref="FieldObject"/> matching the Field Number on the specified [FormObject](./formobject) and [RowObject](./rowobject).            |
| GetFieldValues(string)                        | Returns the values of the field matching the Field Number.            |
| GetHashCode()                                 | Overrides the GetHashCode method for a OptionObjectBase.            |
| GetMultipleIterationStatus(string)            | Returns the Multiple Iteration Status of the form matching the FormId.            |
| GetParentRowId(string)                        | Returns the CurrentRow ParentRowId of the form matching the FormId.            |
| IsFieldEnabled(string)                        | Returns whether the specified field is enabled.            |
| IsFieldLocked(string)                         | Returns whether the specified field is locked.            |
| IsFieldModified(string)                       | Returns whether the specified field is modified.            |
| IsFieldPresent(string)                        | Returns whether the specified field is present.            |
| IsFieldRequired(string)                       | Returns whether the specified field is required.            |
| IsFormPresent(string)                         | Returns whether the specified form is present.            |
| IsRowMarkedForDeletion(string)                | Returns whether the specified [RowObject](./rowobject) is marked for deletion.            |
| IsRowPresent(string)                          | Returns whether the specified row is present            |
| SetDisabledField(string)                      | Sets the specified field as disabled.            |
| SetDisabledFields(List of string)               | Sets the specified fields as disabled.            |
| SetEnabledField(string)                       | Sets the specified field as enabled.            |
| SetEnabledFields(Listof string)                | Sets the specified fields as enabled.            |
| SetFieldValue(string, string)                 | Sets the FieldValue of a [FieldObject](./fieldobject) in the OptionObject on the first form's CurrentRow.            |
| SetFieldValue(string, string, string, string) | Sets the FieldValue of a [FieldObject](./fieldobject) in the OptionObject.            |
| SetLockedField(string)                        | Sets the specified field as locked.            |
| SetLockedFields(List of string)                 | Sets the specified fields as disabled.            |
| SetOptionalField(string)                      | Set the specified field as not required and enables if disabled.            |
| SetOptionalFields(List of string)               | Set the specified fields as not required and enables if disabled.            |
| SetRequiredField(string)                      | Sets the specified field as required.            |
| SetRequiredFields(List of string)               | Sets the specified fields as required.            |
| SetUnlockedField(string)                      | Set the specified field as unlocked.            |
| SetUnlockedFields(List of string)               | Set the specified fields as unlocked.            |
| ToHtmlString()                                | Returns a string with all of the contents of the OptionObject formatted in HTML. |
| ToHtmlString(bool)                            | Returns a string with all of the contents of the OptionObject formatted in HTML. Passing true will include HTML header tags. |
| ToJson()                                      | Returns a string with all of the contents of the OptionObject formatted as JSON.           |
| ToOptionObject()                              | Creates a clone of the OptionObject.            |
| ToOptionObject2()                             | Transforms the OptionObject2 to an OptionObject2.            |
| ToOptionObject2015()                          | Transforms the OptionObject2 as an OptionObject2015.           |
| ToReturnOptionObject()                        | Creates an OptionObject with the minimum information required to return.            |
| ToReturnOptionObject(int, string)             | Creates an OptionObject with the minimum information required to return plus the provided Error Code and Message.            |
| ToXml()                                       | Returns a string with all of the contents of the OptionObject formatted as XML.           |

## Examples

The following code shows how to use OptionObject to construct a web service compatible with myAvatar.
